<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Digi Voting System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Tailwind config: enable Indigo/Aurora palette if needed
    tailwind.config = {
      theme: {
        extend: {
          boxShadow: {
            glow: '0 0 0 2px rgba(99,102,241,0.3), 0 10px 25px -5px rgba(99,102,241,0.35)'
          }
        }
      },
      darkMode: 'class'
    };
  </script>
  <style>
    /* Smooth transitions for theme and UI */
    * { transition: color .2s ease, background-color .2s ease, border-color .2s ease, box-shadow .2s ease; }
    .gradient-bg { background: radial-gradient(1200px 600px at 0% 0%, rgba(99,102,241,.25), transparent 60%), radial-gradient(1200px 600px at 100% 100%, rgba(124,58,237,.25), transparent 60%); }
    .glass { backdrop-filter: blur(10px); background: rgba(255,255,255,0.75); }
    .dark .glass { background: rgba(17,24,39,0.6); }
    /* Simple toast animation */
    .toast-enter { transform: translateY(12px); opacity: 0; }
    .toast-enter-active { transform: translateY(0); opacity: 1; }
  </style>
</head>
<body class="h-full min-h-screen gradient-bg dark:bg-gray-900 dark:text-gray-100">
  <div class="min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-3xl glass rounded-2xl shadow-2xl border border-white/40 dark:border-white/10">
      <!-- Header / Theme Toggle -->
      <div class="flex items-center justify-between p-6 border-b border-black/5 dark:border-white/10">
        <div class="flex items-center gap-3">
          <div class="h-10 w-10 rounded-xl bg-indigo-600 text-white grid place-content-center shadow-glow">üó≥Ô∏è</div>
          <div>
            <h1 class="text-2xl font-extrabold tracking-tight text-indigo-700 dark:text-indigo-300">Digi Voting System</h1>
            <p class="text-sm text-gray-600 dark:text-gray-400">Secure, simple, and elegant voting experience</p>
          </div>
        </div>
        <button id="theme-toggle" class="px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-800">
          Toggle Dark
        </button>
      </div>

      <!-- Content -->
      <div class="p-6">
        <!-- Welcome Section -->
        <section id="welcome-section" class="space-y-6">
          <div class="text-center">
            <h2 class="text-3xl font-bold text-gray-800 dark:text-gray-100">Welcome to the election</h2>
            <p class="mt-2 text-gray-600 dark:text-gray-400">Log in to participate and cast a vote for a preferred candidate</p>
          </div>
          <div class="flex items-center justify-center gap-4">
            <button id="start-voting" class="px-6 py-3 rounded-xl bg-indigo-600 text-white font-semibold shadow-glow hover:bg-indigo-700">
              Start Voting
            </button>
            <button id="admin-link" class="px-6 py-3 rounded-xl border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800">
              Admin Panel
            </button>
          </div>
        </section>

        <!-- Login Section -->
        <section id="login-section" class="hidden">
          <h3 class="text-2xl font-bold mb-4 text-indigo-700 dark:text-indigo-300 text-center">Login to Vote</h3>
          <form id="login-form" class="grid gap-5 max-w-xl mx-auto">
            <!-- Floating label: username -->
            <div class="relative">
              <input id="username" type="text" placeholder=" " required
                     class="peer block w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-white/80 dark:bg-gray-900/60 px-4 pt-5 pb-2.5 text-base text-gray-900 dark:text-gray-100 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none" />
              <label for="username"
                     class="absolute text-sm text-gray-500 dark:text-gray-400 duration-200 transform -translate-y-3 scale-90 top-2 left-4 origin-[0] bg-white/80 dark:bg-gray-900/60 px-1
                            peer-placeholder-shown:top-3.5 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-0 peer-placeholder-shown:left-4
                            peer-focus:top-2 peer-focus:scale-90 peer-focus:-translate-y-3">
                Username
              </label>
            </div>
            <!-- Floating label: password -->
            <div class="relative">
              <input id="password" type="password" placeholder=" " required
                     class="peer block w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-white/80 dark:bg-gray-900/60 px-4 pt-5 pb-2.5 text-base text-gray-900 dark:text-gray-100 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none" />
              <label for="password"
                     class="absolute text-sm text-gray-500 dark:text-gray-400 duration-200 transform -translate-y-3 scale-90 top-2 left-4 origin-[0] bg-white/80 dark:bg-gray-900/60 px-1
                            peer-placeholder-shown:top-3.5 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-0 peer-placeholder-shown:left-4
                            peer-focus:top-2 peer-focus:scale-90 peer-focus:-translate-y-3">
                Password
              </label>
            </div>
            <button type="submit" class="w-full px-6 py-3 rounded-xl bg-green-600 text-white font-semibold hover:bg-green-700 shadow-glow">
              Login and Proceed
            </button>
            <p class="text-center text-sm text-gray-600 dark:text-gray-400">Prototype only: data saved in browser for demo</p>
          </form>
        </section>

        <!-- Voting Section -->
        <section id="vote-section" class="hidden">
          <h3 class="text-2xl font-bold mb-1 text-indigo-700 dark:text-indigo-300 text-center">Cast the vote</h3>
          <p class="mb-6 text-center text-gray-600 dark:text-gray-400">Choose one candidate below</p>

          <form id="vote-form" class="grid gap-4 sm:grid-cols-2">
            <!-- Candidate Card 1 -->
            <label class="group relative flex items-center gap-4 p-4 rounded-2xl border border-gray-200 dark:border-gray-800 hover:border-indigo-400 dark:hover:border-indigo-400 cursor-pointer bg-white/70 dark:bg-gray-900/50">
              <input type="radio" name="candidate" value="candidate1" class="peer sr-only" required />
              <img src="https://i.pravatar.cc/96?img=12" alt="Leader A" class="h-16 w-16 rounded-full object-cover ring-2 ring-transparent group-hover:ring-indigo-300" />
              <div>
                <div class="font-semibold text-gray-900 dark:text-gray-100">Leader A</div>
                <div class="text-sm text-gray-500 dark:text-gray-400">Candidate 1</div>
              </div>
              <span class="ml-auto inline-flex items-center justify-center h-6 w-6 rounded-full border-2 border-gray-300 peer-checked:border-indigo-600 peer-checked:bg-indigo-600 peer-checked:text-white">‚úì</span>
            </label>

            <!-- Candidate Card 2 -->
            <label class="group relative flex items-center gap-4 p-4 rounded-2xl border border-gray-200 dark:border-gray-800 hover:border-indigo-400 dark:hover:border-indigo-400 cursor-pointer bg-white/70 dark:bg-gray-900/50">
              <input type="radio" name="candidate" value="candidate2" class="peer sr-only" required />
              <img src="https://i.pravatar.cc/96?img=32" alt="Leader B" class="h-16 w-16 rounded-full object-cover ring-2 ring-transparent group-hover:ring-indigo-300" />
              <div>
                <div class="font-semibold text-gray-900 dark:text-gray-100">Leader B</div>
                <div class="text-sm text-gray-500 dark:text-gray-400">Candidate 2</div>
              </div>
              <span class="ml-auto inline-flex items-center justify-center h-6 w-6 rounded-full border-2 border-gray-300 peer-checked:border-indigo-600 peer-checked:bg-indigo-600 peer-checked:text-white">‚úì</span>
            </label>

            <!-- Candidate Card 3 -->
            <label class="group relative flex items-center gap-4 p-4 rounded-2xl border border-gray-200 dark:border-gray-800 hover:border-indigo-400 dark:hover:border-indigo-400 cursor-pointer bg-white/70 dark:bg-gray-900/50 sm:col-span-2">
              <input type="radio" name="candidate" value="candidate3" class="peer sr-only" required />
              <img src="https://i.pravatar.cc/96?img=56" alt="Leader C" class="h-16 w-16 rounded-full object-cover ring-2 ring-transparent group-hover:ring-indigo-300" />
              <div>
                <div class="font-semibold text-gray-900 dark:text-gray-100">Leader C</div>
                <div class="text-sm text-gray-500 dark:text-gray-400">Candidate 3</div>
              </div>
              <span class="ml-auto inline-flex items-center justify-center h-6 w-6 rounded-full border-2 border-gray-300 peer-checked:border-indigo-600 peer-checked:bg-indigo-600 peer-checked:text-white">‚úì</span>
            </label>

            <button type="submit" class="mt-2 sm:mt-0 sm:col-span-2 px-6 py-3 rounded-xl bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow-glow">
              Submit Vote
            </button>
          </form>
        </section>

        <!-- Success Section -->
        <section id="success-section" class="hidden text-center">
          <div class="mx-auto my-6 h-16 w-16 rounded-full bg-green-100 text-green-700 grid place-content-center text-3xl">‚úÖ</div>
          <h3 class="text-2xl font-bold text-green-700 dark:text-green-300">Vote submitted!</h3>
          <p class="mt-2 text-gray-600 dark:text-gray-400">Thanks for participating, the vote has been recorded locally for this demo</p>
          <div class="mt-6">
            <button id="back-to-welcome" class="px-6 py-3 rounded-xl bg-indigo-600 text-white font-semibold hover:bg-indigo-700 shadow">
              Back to Start
            </button>
          </div>
        </section>

        <!-- Admin Dashboard -->
        <section id="admin-dashboard" class="hidden">
          <h3 class="text-2xl font-bold mb-2 text-red-700 dark:text-red-300 text-center">Admin Dashboard</h3>
          <p class="mb-6 text-center text-gray-600 dark:text-gray-400">Live results from localStorage (demo only)</p>

          <ul id="vote-results" class="mb-6 grid gap-3"></ul>

          <div class="flex flex-wrap items-center justify-center gap-3">
            <button id="clear-votes" class="px-5 py-2.5 rounded-xl bg-red-600 text-white font-semibold hover:bg-red-700">
              Clear All Votes
            </button>
            <button id="back-from-admin" class="px-5 py-2.5 rounded-xl border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800">
              Back to Start
            </button>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Admin Modal -->
  <div id="admin-modal" class="hidden fixed inset-0 z-50">
    <div class="absolute inset-0 bg-black/50"></div>
    <div class="relative mx-auto mt-24 w-full max-w-md p-6">
      <div class="glass rounded-2xl border border-white/30 dark:border-white/10 p-6">
        <div class="flex items-center justify-between">
          <h4 class="text-xl font-semibold">Admin Login</h4>
          <button id="close-admin" class="h-9 w-9 grid place-content-center rounded-full hover:bg-gray-200/60 dark:hover:bg-gray-800">‚úï</button>
        </div>
        <form id="admin-form" class="mt-4 grid gap-4">
          <div class="relative">
            <input id="admin-username" type="text" placeholder=" " required
                   class="peer block w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-white/80 dark:bg-gray-900/60 px-4 pt-5 pb-2.5 text-base focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none" />
            <label for="admin-username"
                   class="absolute text-sm text-gray-500 dark:text-gray-400 duration-200 transform -translate-y-3 scale-90 top-2 left-4 origin-[0] bg-white/80 dark:bg-gray-900/60 px-1
                          peer-placeholder-shown:top-3.5 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-0 peer-placeholder-shown:left-4
                          peer-focus:top-2 peer-focus:scale-90 peer-focus:-translate-y-3">
              Username
            </label>
          </div>
          <div class="relative">
            <input id="admin-password" type="password" placeholder=" " required
                   class="peer block w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-white/80 dark:bg-gray-900/60 px-4 pt-5 pb-2.5 text-base focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none" />
            <label for="admin-password"
                   class="absolute text-sm text-gray-500 dark:text-gray-400 duration-200 transform -translate-y-3 scale-90 top-2 left-4 origin-[0] bg-white/80 dark:bg-gray-900/60 px-1
                          peer-placeholder-shown:top-3.5 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-0 peer-placeholder-shown:left-4
                          peer-focus:top-2 peer-focus:scale-90 peer-focus:-translate-y-3">
              Password
            </label>
          </div>
          <div class="flex gap-3">
            <button type="submit" class="flex-1 px-5 py-2.5 rounded-xl bg-red-600 text-white font-semibold hover:bg-red-700">Login</button>
            <button type="button" id="cancel-admin" class="flex-1 px-5 py-2.5 rounded-xl border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toast-container" class="fixed bottom-4 left-1/2 -translate-x-1/2 z-50 space-y-2"></div>

  <script>
    // Dark mode toggle using class strategy with localStorage
    // Based on Tailwind dark mode docs
    const root = document.documentElement;
    const THEME_KEY = 'theme';
    function applyTheme() {
      const saved = localStorage.getItem(THEME_KEY);
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const isDark = saved ? saved === 'dark' : prefersDark;
      root.classList.toggle('dark', isDark);
    }
    applyTheme();
    document.getElementById('theme-toggle').addEventListener('click', () => {
      const currentDark = root.classList.contains('dark');
      localStorage.setItem(THEME_KEY, currentDark ? 'light' : 'dark');
      applyTheme();
    });

    // Simple toast notification (success/error/info)
    function showToast(message, type = 'info') {
      const container = document.getElementById('toast-container');
      const wrap = document.createElement('div');
      const colors = {
        success: 'bg-green-600',
        error: 'bg-red-600',
        info: 'bg-gray-800'
      };
      wrap.className = `toast-enter ${colors[type]} text-white px-4 py-3 rounded-xl shadow-lg`;
      wrap.textContent = message;
      container.appendChild(wrap);
      // Enter animation
      requestAnimationFrame(() => wrap.classList.add('toast-enter-active'));
      setTimeout(() => {
        wrap.classList.remove('toast-enter-active');
        wrap.style.opacity = '0';
        wrap.style.transform = 'translateY(12px)';
        setTimeout(() => wrap.remove(), 200);
      }, 2400);
    }

    // Section helpers
    const sections = {
      welcome: document.getElementById('welcome-section'),
      login: document.getElementById('login-section'),
      vote: document.getElementById('vote-section'),
      success: document.getElementById('success-section'),
      admin: document.getElementById('admin-dashboard'),
      adminModal: document.getElementById('admin-modal')
    };

    function showOnly(id) {
      Object.values(sections).forEach(s => s.classList?.add('hidden'));
      sections[id].classList.remove('hidden');
    }

    // Start voting
    document.getElementById('start-voting').addEventListener('click', () => {
      showOnly('login');
    });

    // Login form
    document.getElementById('login-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const username = document.getElementById('username').value.trim();
      localStorage.setItem('currentUser', username);
      showToast('Login successful', 'success');
      showOnly('vote');
    });

    // Vote form
    document.getElementById('vote-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const voted = localStorage.getItem('hasVoted');
      if (voted === 'true') {
        showToast('Already voted in this session', 'error');
        return;
      }

      const chosen = document.querySelector('input[name="candidate"]:checked');
      if (!chosen) {
        showToast('Please select a candidate', 'error');
        return;
      }

      const candidate = chosen.value;
      const username = localStorage.getItem('currentUser') || 'Unknown User';

      // Save vote
      localStorage.setItem('hasVoted', 'true');
      const votes = JSON.parse(localStorage.getItem('votes') || '{}');
      votes[candidate] = votes[candidate] || { count: 0, voters: [] };
      votes[candidate].count++;
      votes[candidate].voters.push(username);
      localStorage.setItem('votes', JSON.stringify(votes));

      showToast('Vote submitted', 'success');
      showOnly('success');
    });

    // Success back
    document.getElementById('back-to-welcome').addEventListener('click', () => {
      localStorage.removeItem('hasVoted');
      showOnly('welcome');
    });

    // Admin modal open/close
    document.getElementById('admin-link').addEventListener('click', () => {
      sections.adminModal.classList.remove('hidden');
    });
    document.getElementById('close-admin').addEventListener('click', () => {
      sections.adminModal.classList.add('hidden');
    });
    document.getElementById('cancel-admin').addEventListener('click', () => {
      sections.adminModal.classList.add('hidden');
    });

    // Admin auth + dashboard
    function displayVotes() {
      const votes = JSON.parse(localStorage.getItem('votes') || '{}');
      const results = document.getElementById('vote-results');
      results.innerHTML = '';
      const map = {
        candidate1: 'Candidate 1',
        candidate2: 'Candidate 2',
        candidate3: 'Candidate 3'
      };
      const avatars = {
        candidate1: 'https://i.pravatar.cc/64?img=12',
        candidate2: 'https://i.pravatar.cc/64?img=32',
        candidate3: 'https://i.pravatar.cc/64?img=56'
      };

      Object.entries(votes).forEach(([key, value]) => {
        const li = document.createElement('li');
        li.className = 'flex items-center gap-4 p-4 rounded-xl border border-gray-200 dark:border-gray-800 bg-white/70 dark:bg-gray-900/50';
        li.innerHTML = `
          <img src="${avatars[key] || 'https://i.pravatar.cc/64'}" alt="${map[key] || key}" class="h-12 w-12 rounded-full object-cover" />
          <div>
            <div class="font-semibold">${map[key] || key}</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Voters: ${(value.voters || []).join(', ') || '‚Äî'}</div>
          </div>
          <span class="ml-auto inline-flex items-center gap-2">
            <span class="px-2.5 py-1 rounded-lg bg-indigo-600 text-white text-sm">${value.count || 0} vote(s)</span>
          </span>
        `;
        results.appendChild(li);
      });

      if (!results.children.length) {
        const empty = document.createElement('div');
        empty.className = 'text-center text-gray-500 dark:text-gray-400';
        empty.textContent = 'No votes recorded yet';
        results.appendChild(empty);
      }
    }

    document.getElementById('admin-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const u = document.getElementById('admin-username').value.trim();
      const p = document.getElementById('admin-password').value;
      if (u === 'arpit001' && p === 'Arpit@11') {
        sections.adminModal.classList.add('hidden');
        displayVotes();
        showOnly('admin');
        showToast('Admin login successful', 'success');
      } else {
        showToast('Invalid admin credentials', 'error');
      }
      e.target.reset();
    });

    document.getElementById('clear-votes').addEventListener('click', () => {
      if (confirm('Clear all votes?')) {
        localStorage.removeItem('votes');
        localStorage.removeItem('hasVoted');
        displayVotes();
        showToast('All votes cleared', 'info');
      }
    });

    document.getElementById('back-from-admin').addEventListener('click', () => {
      showOnly('welcome');
    });
  </script>
</body>
</html>
